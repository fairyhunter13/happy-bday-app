<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Summary - Happy Birthday App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            line-height: 1.6;
        }

        header {
            background-color: #2d2d2d;
            padding: 1.5rem 2rem;
            border-bottom: 2px solid #4a9eff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        header h1 {
            color: #4a9eff;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        header p {
            color: #b0b0b0;
            font-size: 0.95rem;
        }

        nav {
            background-color: #252525;
            padding: 1rem 2rem;
            border-bottom: 1px solid #3a3a3a;
            overflow-x: auto;
            white-space: nowrap;
        }

        nav a {
            color: #4a9eff;
            text-decoration: none;
            padding: 0.5rem 1rem;
            margin-right: 0.5rem;
            border-radius: 4px;
            display: inline-block;
            transition: background-color 0.2s;
        }

        nav a:hover {
            background-color: #3a3a3a;
        }

        nav a.active {
            background-color: #4a9eff;
            color: #1a1a1a;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .vulnerability-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .vuln-card {
            background-color: #2d2d2d;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #3a3a3a;
            text-align: center;
        }

        .vuln-card h3 {
            color: #b0b0b0;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        .vuln-card .count {
            font-size: 2.5rem;
            font-weight: 600;
        }

        .vuln-card.critical .count {
            color: #d0021b;
        }

        .vuln-card.high .count {
            color: #f5a623;
        }

        .vuln-card.medium .count {
            color: #f8e71c;
        }

        .vuln-card.low .count {
            color: #7ed321;
        }

        .section {
            background-color: #2d2d2d;
            padding: 2rem;
            border-radius: 8px;
            border: 1px solid #3a3a3a;
            margin-bottom: 2rem;
        }

        .section h2 {
            color: #e0e0e0;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .scan-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .scan-table th,
        .scan-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #3a3a3a;
        }

        .scan-table th {
            background-color: #252525;
            color: #b0b0b0;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .scan-table td {
            color: #e0e0e0;
        }

        .scan-table tr:last-child td {
            border-bottom: none;
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-badge.success {
            background-color: #2d5016;
            color: #7ed321;
        }

        .status-badge.pending {
            background-color: #4a3a00;
            color: #f5a623;
        }

        .status-badge.error {
            background-color: #4a0e0e;
            color: #d0021b;
        }

        .info-box {
            background-color: #252525;
            padding: 1.5rem;
            border-radius: 6px;
            border-left: 4px solid #4a9eff;
            margin-top: 1.5rem;
        }

        .info-box h3 {
            color: #4a9eff;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .info-box p {
            color: #b0b0b0;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .info-box a {
            color: #4a9eff;
            text-decoration: none;
        }

        .info-box a:hover {
            text-decoration: underline;
        }

        footer {
            background-color: #2d2d2d;
            padding: 1.5rem 2rem;
            text-align: center;
            color: #808080;
            border-top: 1px solid #3a3a3a;
            margin-top: 3rem;
        }

        footer a {
            color: #4a9eff;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.4rem;
            }

            .container {
                padding: 1rem;
            }

            nav {
                padding: 0.5rem 1rem;
            }

            nav a {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }

            .vulnerability-grid {
                grid-template-columns: 1fr 1fr;
            }

            .scan-table {
                font-size: 0.85rem;
            }

            .scan-table th,
            .scan-table td {
                padding: 0.75rem 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Security Summary</h1>
        <p>Comprehensive security scan results and vulnerability tracking</p>
    </header>

    <nav>
        <a href="index.html">API Docs</a>
        <a href="reports-summary.html">Reports Hub</a>
        <a href="test-reports.html">Test Reports</a>
        <a href="coverage-trends.html">Coverage Trends</a>
        <a href="security-summary.html" class="active">Security Summary</a>
    </nav>

    <div class="container">
        <div class="vulnerability-grid">
            <div class="vuln-card critical">
                <h3>Critical</h3>
                <div class="count" id="critical-count">0</div>
            </div>
            <div class="vuln-card high">
                <h3>High</h3>
                <div class="count" id="high-count">0</div>
            </div>
            <div class="vuln-card medium">
                <h3>Medium</h3>
                <div class="count" id="medium-count">0</div>
            </div>
            <div class="vuln-card low">
                <h3>Low</h3>
                <div class="count" id="low-count">0</div>
            </div>
        </div>

        <div class="section">
            <h2>Security Scan Status</h2>
            <table class="scan-table">
                <thead>
                    <tr>
                        <th>Scan Type</th>
                        <th>Status</th>
                        <th>Last Run</th>
                        <th>Issues Found</th>
                    </tr>
                </thead>
                <tbody id="scans-table-body">
                    <!-- Scan rows will be populated dynamically from security-data.json -->
                    <tr>
                        <td>Dependency Scan (npm audit)</td>
                        <td><span class="status-badge success" id="npm-audit-status">Passed</span></td>
                        <td id="npm-audit-time">Via CI/CD</td>
                        <td id="npm-audit-issues">0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>OWASP Top 10 Coverage</h2>
            <table class="scan-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Protection Status</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>A01:2021 - Broken Access Control</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>JWT authentication, role-based access control</td>
                    </tr>
                    <tr>
                        <td>A02:2021 - Cryptographic Failures</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>HTTPS enforced, secure password hashing</td>
                    </tr>
                    <tr>
                        <td>A03:2021 - Injection</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>Input validation, parameterized queries</td>
                    </tr>
                    <tr>
                        <td>A04:2021 - Insecure Design</td>
                        <td><span class="status-badge pending">Review</span></td>
                        <td>Architecture review recommended</td>
                    </tr>
                    <tr>
                        <td>A05:2021 - Security Misconfiguration</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>Security headers, minimal permissions</td>
                    </tr>
                    <tr>
                        <td>A06:2021 - Vulnerable Components</td>
                        <td><span class="status-badge pending">Monitoring</span></td>
                        <td>Automated dependency scanning enabled</td>
                    </tr>
                    <tr>
                        <td>A07:2021 - Authentication Failures</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>Strong password policy, rate limiting</td>
                    </tr>
                    <tr>
                        <td>A08:2021 - Data Integrity Failures</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>Digital signatures, integrity checks</td>
                    </tr>
                    <tr>
                        <td>A09:2021 - Logging & Monitoring Failures</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>Comprehensive logging, alerting</td>
                    </tr>
                    <tr>
                        <td>A10:2021 - Server-Side Request Forgery</td>
                        <td><span class="status-badge success">Protected</span></td>
                        <td>URL validation, allowlist filtering</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="info-box">
            <h3>Additional Security Resources</h3>
            <p>For detailed vulnerability information and security advisories, please visit:</p>
            <p><a href="https://github.com/fairyhunter13/happy-bday-app/security" target="_blank">GitHub Security Tab &rarr;</a></p>
            <p><a href="https://github.com/fairyhunter13/happy-bday-app/security/dependabot" target="_blank">Dependabot Alerts &rarr;</a></p>
            <p><a href="https://github.com/fairyhunter13/happy-bday-app/security/code-scanning" target="_blank">Code Scanning Alerts &rarr;</a></p>
        </div>

        <div class="info-box" style="border-left-color: #7ed321; margin-top: 1rem;">
            <h3>Security Best Practices</h3>
            <p>This project follows industry-standard security practices:</p>
            <p>- Automated dependency scanning with npm audit and Snyk</p>
            <p>- Container image scanning with Trivy</p>
            <p>- Static Application Security Testing (SAST) with Semgrep</p>
            <p>- Secret detection with Gitleaks</p>
            <p>- Regular security updates and patches</p>
            <p>- Security headers and HTTPS enforcement</p>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 Happy Birthday App | <a href="https://github.com/fairyhunter13/happy-bday-app" target="_blank">View on GitHub</a></p>
        <p style="margin-top: 0.5rem; font-size: 0.85rem;">Last updated: <span id="last-updated"></span></p>
    </footer>

    <script>
        // Set last updated timestamp
        document.getElementById('last-updated').textContent = new Date().toLocaleString();

        // Load security data from JSON file (to be populated by CI/CD)
        fetch('./security-data.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Security data not found');
                }
                return response.json();
            })
            .then(data => {
                // Update vulnerability counts
                if (data.vulnerabilities) {
                    document.getElementById('critical-count').textContent = data.vulnerabilities.critical || 0;
                    document.getElementById('high-count').textContent = data.vulnerabilities.high || 0;
                    document.getElementById('medium-count').textContent = data.vulnerabilities.medium || 0;
                    document.getElementById('low-count').textContent = data.vulnerabilities.low || 0;
                }

                // Update scan status table dynamically
                if (data.scans) {
                    const tableBody = document.getElementById('scans-table-body');
                    tableBody.innerHTML = ''; // Clear existing rows

                    // Define scan order for display
                    const scanOrder = ['npm_audit', 'snyk', 'trivy', 'sonarcloud', 'gitleaks', 'license'];

                    scanOrder.forEach(scanKey => {
                        const scan = data.scans[scanKey];
                        if (!scan) return;

                        const row = document.createElement('tr');

                        // Determine status badge styling
                        let statusClass = '';
                        let statusText = '';
                        let statusStyle = '';

                        if (scan.status === 'success') {
                            statusClass = 'status-badge success';
                            statusText = 'Passed';
                        } else if (scan.status === 'failed' || scan.status === 'error') {
                            statusClass = 'status-badge error';
                            statusText = 'Failed';
                        } else if (scan.status === 'warning') {
                            statusClass = 'status-badge pending';
                            statusText = 'Warning';
                        } else {
                            statusClass = 'status-badge';
                            statusStyle = 'background-color: #3a3a3a; color: #888;';
                            statusText = 'Not configured';
                        }

                        const issues = scan.status === 'not_configured' ? 'N/A' : (scan.issues || 0);

                        row.innerHTML = `
                            <td>${scan.name || scanKey}</td>
                            <td><span class="${statusClass}" style="${statusStyle}">${statusText}</span></td>
                            <td>${scan.lastRun || 'Not configured'}</td>
                            <td>${issues}</td>
                        `;

                        tableBody.appendChild(row);
                    });
                }
            })
            .catch(error => {
                console.log('Security data will be populated by CI/CD pipeline');
                // Keep placeholder values
            });
    </script>
</body>
</html>
