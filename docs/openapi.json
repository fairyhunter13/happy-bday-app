{
  "openapi": "3.0.3",
  "info": {
    "title": "Birthday Message Scheduler API",
    "description": "## Overview\nProduction-ready API for scheduling birthday and anniversary messages with timezone support.\n\n## Features\n- **User Management**: CRUD operations for users with timezone support\n- **Message Scheduling**: Automatic message scheduling based on user timezone\n- **Message Logs**: Track all scheduled and sent messages\n- **Health Monitoring**: System health and readiness endpoints\n\n## Architecture\n- **Database**: PostgreSQL with Drizzle ORM\n- **Queue**: RabbitMQ for message processing\n- **Scheduler**: CRON-based scheduling with timezone awareness",
    "version": "1.0.0",
    "contact": {
      "name": "API Support",
      "email": "support@example.com"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "components": {
    "schemas": {
      "def-0": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "email": {
            "type": "string",
            "format": "email"
          },
          "timezone": {
            "type": "string",
            "example": "America/New_York"
          },
          "birthdayDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "anniversaryDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "locationCity": {
            "type": "string",
            "nullable": true
          },
          "locationCountry": {
            "type": "string",
            "nullable": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "title": "User"
      },
      "def-1": {
        "type": "object",
        "required": [
          "firstName",
          "lastName",
          "email",
          "timezone"
        ],
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "lastName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "email": {
            "type": "string",
            "format": "email"
          },
          "timezone": {
            "type": "string",
            "example": "America/New_York"
          },
          "birthdayDate": {
            "type": "string",
            "format": "date-time"
          },
          "anniversaryDate": {
            "type": "string",
            "format": "date-time"
          },
          "locationCity": {
            "type": "string",
            "maxLength": 100
          },
          "locationCountry": {
            "type": "string",
            "maxLength": 100
          }
        },
        "title": "CreateUserRequest"
      },
      "def-2": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "lastName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "email": {
            "type": "string",
            "format": "email"
          },
          "timezone": {
            "type": "string",
            "example": "America/New_York"
          },
          "birthdayDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "anniversaryDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "locationCity": {
            "type": "string",
            "maxLength": 100,
            "nullable": true
          },
          "locationCountry": {
            "type": "string",
            "maxLength": 100,
            "nullable": true
          }
        },
        "title": "UpdateUserRequest"
      },
      "def-3": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "userId": {
            "type": "string",
            "format": "uuid"
          },
          "messageType": {
            "type": "string",
            "enum": [
              "BIRTHDAY",
              "ANNIVERSARY"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "PENDING",
              "QUEUED",
              "SENT",
              "FAILED"
            ]
          },
          "scheduledSendTime": {
            "type": "string",
            "format": "date-time"
          },
          "sentAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "messageContent": {
            "type": "string",
            "nullable": true
          },
          "retryCount": {
            "type": "integer"
          },
          "errorMessage": {
            "type": "string",
            "nullable": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "title": "MessageLog"
      },
      "def-4": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy"
            ]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "uptime": {
            "type": "number"
          },
          "version": {
            "type": "string"
          }
        },
        "title": "HealthResponse"
      },
      "def-5": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false
          },
          "error": {
            "type": "object",
            "properties": {
              "code": {
                "type": "string"
              },
              "message": {
                "type": "string"
              },
              "details": {
                "type": "object"
              }
            }
          }
        },
        "title": "ErrorResponse"
      },
      "def-6": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object"
          },
          "meta": {
            "type": "object",
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time"
              },
              "requestId": {
                "type": "string"
              }
            }
          }
        },
        "title": "SuccessResponse"
      },
      "def-7": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "array",
            "items": {
              "type": "object"
            }
          },
          "meta": {
            "type": "object",
            "properties": {
              "total": {
                "type": "integer"
              },
              "page": {
                "type": "integer"
              },
              "limit": {
                "type": "integer"
              },
              "totalPages": {
                "type": "integer"
              }
            }
          }
        },
        "title": "PaginatedResponse"
      }
    }
  },
  "paths": {
    "/health": {
      "get": {
        "summary": "Health check",
        "tags": [
          "health"
        ],
        "description": "Check if the service is running",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-4"
                }
              }
            }
          }
        }
      }
    },
    "/ready": {
      "get": {
        "summary": "Readiness check",
        "tags": [
          "health"
        ],
        "description": "Check if the service is ready to accept requests",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-4"
                }
              }
            }
          },
          "503": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      }
    },
    "/live": {
      "get": {
        "summary": "Liveness check",
        "tags": [
          "health"
        ],
        "description": "Kubernetes liveness probe - checks if the service is alive",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-4"
                }
              }
            }
          }
        }
      }
    },
    "/health/schedulers": {
      "get": {
        "summary": "Scheduler health check",
        "tags": [
          "health"
        ],
        "description": "Check the health status of all CRON schedulers",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          }
        }
      }
    },
    "/metrics": {
      "get": {
        "summary": "Prometheus metrics",
        "tags": [
          "metrics"
        ],
        "description": "Get Prometheus-formatted metrics for monitoring",
        "responses": {
          "200": {
            "description": "Prometheus text format metrics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Prometheus text format metrics"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/summary": {
      "get": {
        "summary": "Metrics summary",
        "tags": [
          "metrics"
        ],
        "description": "Get a JSON summary of all metrics for debugging",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users": {
      "post": {
        "summary": "Create a new user",
        "tags": [
          "users"
        ],
        "description": "Create a new user with timezone support",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/def-1"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "400": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          },
          "409": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List all users",
        "tags": [
          "users"
        ],
        "description": "Get a paginated list of users",
        "parameters": [
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "in": "query",
            "name": "page",
            "required": false
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "in": "query",
            "name": "limit",
            "required": false
          },
          {
            "schema": {
              "type": "string"
            },
            "in": "query",
            "name": "timezone",
            "required": false
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-7"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{id}": {
      "get": {
        "summary": "Get user by ID",
        "tags": [
          "users"
        ],
        "description": "Retrieve a specific user by their ID",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "in": "path",
            "name": "id",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "404": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update user",
        "tags": [
          "users"
        ],
        "description": "Update an existing user",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/def-2"
              }
            }
          }
        },
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "in": "path",
            "name": "id",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "400": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          },
          "404": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          },
          "409": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete user",
        "tags": [
          "users"
        ],
        "description": "Soft delete a user",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "in": "path",
            "name": "id",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "404": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/messages": {
      "get": {
        "summary": "List message logs",
        "tags": [
          "messages"
        ],
        "description": "Get a paginated list of message logs",
        "parameters": [
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "in": "query",
            "name": "page",
            "required": false
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "in": "query",
            "name": "limit",
            "required": false
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "PENDING",
                "QUEUED",
                "SENT",
                "FAILED"
              ]
            },
            "in": "query",
            "name": "status",
            "required": false
          },
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "in": "query",
            "name": "userId",
            "required": false
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "BIRTHDAY",
                "ANNIVERSARY"
              ]
            },
            "in": "query",
            "name": "messageType",
            "required": false
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-7"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/messages/{id}": {
      "get": {
        "summary": "Get message log by ID",
        "tags": [
          "messages"
        ],
        "description": "Retrieve a specific message log by its ID",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "in": "path",
            "name": "id",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "404": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/scheduler/status": {
      "get": {
        "summary": "Get scheduler status",
        "tags": [
          "scheduler"
        ],
        "description": "Check the status of all schedulers",
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/scheduler/trigger": {
      "post": {
        "summary": "Trigger scheduler manually",
        "tags": [
          "scheduler"
        ],
        "description": "Manually trigger the message scheduler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "minute",
                      "daily"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-6"
                }
              }
            }
          },
          "400": {
            "description": "Default Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/def-5"
                }
              }
            }
          }
        }
      }
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    },
    {
      "url": "https://api.example.com",
      "description": "Production server"
    }
  ],
  "tags": [
    {
      "name": "health",
      "description": "Health check endpoints for monitoring and orchestration"
    },
    {
      "name": "metrics",
      "description": "Prometheus metrics endpoints for observability"
    },
    {
      "name": "users",
      "description": "User management operations"
    },
    {
      "name": "messages",
      "description": "Message log operations"
    },
    {
      "name": "scheduler",
      "description": "Scheduler operations"
    }
  ]
}